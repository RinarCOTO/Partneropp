---
import ChevronDown from '../assets/icons/down-chevron.svg';

interface Props {
  items: { text: string }[];
}

const { items } = Astro.props;
---

<style>
.b2b-lp-accordion {
  position: relative;
  display: flex;
  flex-direction: column;
  width: 100%;
  border: 2px solid transparent;
  background: 
    linear-gradient(rgb(0, 0, 0), rgb(0, 0, 0)) padding-box,
    linear-gradient(130deg, rgba(220,160,121,1), rgba(130,102,157,1)) border-box;
  background-clip: padding-box, border-box;
  background-origin: padding-box, border-box;
  color: white;
  border-radius: 30px;
  overflow: hidden; 
  transition: all 0.3s ease;
  z-index: 1;
}
@media (min-width: 768px) {
  .b2b-lp-accordion:hover {
    background: 
      linear-gradient(rgba(20, 20, 20, 0.7), rgba(0, 0, 0, 0.9)) padding-box,
      linear-gradient(130deg, rgba(220,160,121,1), rgba(220,160,121,1)) border-box;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
  }
}
.accordion-btn {
  position: relative;
  height: 100px;
  padding: 15px 50px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  background: transparent;
  border: none;
  width: 100%;
  color: inherit;
  font: inherit;
  z-index: 2;
}

.accordion-menu {
  display: grid;
  grid-template-rows: 0fr;
  transition: grid-template-rows 0.35s ease, opacity 0.3s ease;
  opacity: 0;
}

.accordion-menu > div {
  overflow: hidden;
  padding: 0 30px;
}

.accordion-menu p {
  margin: 0;
  padding: 0px 16px 16px;
  color: white;
  transition: color 0.2s ease;
}
.open .accordion-menu {
  grid-template-rows: 1fr;
  opacity: 1;
}

/* Chevron rotation */
.chevron {
  transition: transform 0.3s ease;
}
.open .chevron {
  transform: rotate(180deg);
}

/* desktop hover (optional) */
@media (min-width: 768px) {
  .b2b-lp-accordion:hover .accordion-menu {
    grid-template-rows: 1fr;
    opacity: 1;
  }
  .b2b-lp-accordion:hover .chevron {
    transform: rotate(180deg);
  }
}
</style>

<div class="b2b-lp-accordion max-w-[812px]" data-accordion>
  <button class="accordion-btn">
    <span class="label-text">
      <slot name="label" />
    </span>
    <span class="chevron">
      <img src={ChevronDown.src} alt="" />
    </span>
  </button>

  <div class="accordion-menu">
    <div>
      {items.map((item) => (
        <p>{item.text}</p>
      ))}
    </div>
  </div>
</div>

<script type="module">
  const accordions = document.querySelectorAll('[data-accordion]');

  accordions.forEach((accordion) => {
    const btn = accordion.querySelector('.accordion-btn');

    btn.addEventListener('click', (e) => {
      if (window.innerWidth < 768) {
        e.preventDefault();

        // Close all others (accordion behavior)
        accordions.forEach((a) => a !== accordion && a.classList.remove('open'));

        // Toggle current
        accordion.classList.toggle('open');
      }
    });
  });
</script>
